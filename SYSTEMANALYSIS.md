# System Analysis Document: Media Location Analyser and Travel Price Fetcher

## Overview

This document outlines the design of the Media Location Analyser and Travel Price Fetcher system. It includes class diagrams, entity-relationship diagrams, and sequence diagrams to illustrate the system's structure, data relationships, and interaction flow.

## 1. Class Diagram

The following table summarises the classes used in the system, their attributes, methods, and relationships.

| **Class**           | **Attributes**                                               | **Methods**                               | **Relationships**                                     | **Description**                                                                                                                                   |
|---------------------|--------------------------------------------------------------|-------------------------------------------|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| `MediaAnalyser`     | `filePath: String`                                           | `analyseMedia()`                          | Aggregates `GoogleVideoIntelligenceAPI`, uses `GoogleResponseParser` | Handles the media analysis by utilising Google Cloud Video Intelligence API to extract objects, labels, and text from the media file.              |
| `GoogleVideoIntelligenceAPI` | `apiKey: String`                                          | `annotate()`                              | Aggregated by `MediaAnalyser`                                     | Interfaces with the Google Video Intelligence API to annotate the video/image file.                                                               |
| `GoogleResponseParser`| `annotations: Object`                                       | `parseAnnotations()`                      | Used by `MediaAnalyser`                                            | Parses the annotations returned by the Google API and extracts relevant entities like objects, labels, and text.                                   |
| `LocationComparer`  | `knownLocations: Map<String, List<String>>`                   | `compareAndScoreLocations(entities)`      | Used by `MainApp`                                                  | Compares parsed entities against known locations and scores them to determine the most likely location.                                           |
| `FlightPriceFetcher`| `apiKey: String`                                             | `fetchFlightPrices(destination)`          | Used by `MainApp`                                                  | Fetches flight prices based on the detected location using a flight pricing API.                                                                   |
| `HotelPriceFetcher` | `apiKey: String`                                             | `fetchHotelPrices(destination)`           | Used by `MainApp`                                                  | Fetches hotel prices based on the detected location using a hotel pricing API.                                                                    |
| `MainApp`           | `mediaFilePath: String`, `location: String`, `score: int`    | `main()`, `createToggleButton()`, `displayHotelPrices()` | Aggregates `MediaAnalyser`, `LocationComparer`, `FlightPriceFetcher`, `HotelPriceFetcher` | Coordinates the entire process: media analysis, location detection, fetching prices, and UI interaction.                                          |

## 2. Entity-Relationship Diagram (ERD)

The ERD conceptualises how different entities (classes) are related to each other, particularly focusing on data parsing and processing.

| **Entity**               | **Attributes**                              | **Relationships**                                           | **Description**                                                                                                   |
|--------------------------|---------------------------------------------|-------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| `MediaFile`              | `filePath`, `mediaType`                     | Analysed by `MediaAnalyser`                                  | Represents the media file (video/image) that is to be analysed.                                                   |
| `AnnotationResult`       | `objects`, `labels`, `texts`                | Generated by `GoogleVideoIntelligenceAPI`, Parsed by `GoogleResponseParser` | Contains the result of media analysis, including detected objects, labels, and text.                              |
| `DetectedEntity`         | `description`, `entityType`                 | Part of `AnnotationResult`, Compared by `LocationComparer`   | Represents a detected entity (object, label, or text) within the media file.                                      |
| `Location`               | `name`, `keywords`, `score`                 | Associated with `DetectedEntity`                             | Represents a geographical location, with associated keywords used for matching detected entities.                 |
| `FlightPrice`            | `price`, `departureDate`, `returnDate`      | Fetched by `FlightPriceFetcher`                              | Contains information about flight prices for a specific location and date range.                                  |
| `HotelPrice`             | `topTierPrice`, `mediumTierPrice`, `budgetTierPrice` | Fetched by `HotelPriceFetcher`                               | Contains information about hotel prices in different tiers for a specific location.                               |

### ERD Relationships
- **MediaFile** 1-->* **AnnotationResult**: A media file is analysed to produce annotation results.
- **AnnotationResult** 1-->* **DetectedEntity**: An annotation result contains multiple detected entities.
- **Location** 1-->* **DetectedEntity**: Each detected entity can be associated with multiple locations based on matching keywords.
- **FlightPriceFetcher** *-->* **Location**: Fetches flight prices for a given location.
- **HotelPriceFetcher** *-->* **Location**: Fetches hotel prices for a given location.

## 3. Sequence Diagram

The sequence diagram shows the flow of interaction between different components (classes) of the system, particularly focusing on data parsing and location detection.

| **Step** | **Object/Entity**       | **Method/Action**                                          | **Description**                                                                                             |
|----------|-------------------------|------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| 1        | `MainApp`                | `main(filePath)`                                           | The main application starts and receives the file path of the media to analyse.                             |
| 2        | `MainApp -> MediaAnalyser`| `analyseMedia(filePath)`                                   | The main app calls the media analyser to process the file.                                                  |
| 3        | `MediaAnalyser -> GoogleVideoIntelligenceAPI`| `annotate(filePath)`                                       | The media analyser invokes the Google Video Intelligence API to annotate the media.                         |
| 4        | `GoogleVideoIntelligenceAPI -> GoogleResponseParser` | `parseAnnotations(annotations)`                            | The API returns annotations, which are then parsed by the response parser.                                  |
| 5        | `GoogleResponseParser -> MediaAnalyser` | `return parsed data (objects, labels, texts)`               | The parsed data is returned to the media analyser.                                                          |
| 6        | `MainApp -> LocationComparer`| `compareAndScoreLocations(parsed entities)`               | The main app calls the location comparer to identify the most likely location based on parsed entities.      |
| 7        | `LocationComparer -> MainApp`| `return location and score`                                | The location comparer returns the best-matching location and its score.                                     |
| 8        | `MainApp -> FlightPriceFetcher` | `fetchFlightPrices(location)`                             | The main app fetches flight prices for the identified location.                                             |
| 9        | `MainApp -> HotelPriceFetcher` | `fetchHotelPrices(location)`                              | The main app fetches hotel prices for the identified location.                                              |
| 10       | `MainApp`                | `displayHotelPrices(hotelPrices)`                          | The main app displays the fetched hotel prices and creates a toggle button on the webpage.                  |

## Conclusion

This design document outlines the architecture of the Media Location Analyser and Travel Price Fetcher system, focusing on class structure, data relationships, and the sequence of operations. The diagrams provide a clear understanding of how data is parsed, analysed, and utilised to deliver the final output.

